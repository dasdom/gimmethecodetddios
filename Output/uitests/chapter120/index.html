<!DOCTYPE html><html><head><meta charset="UTF-8"/><meta name="og:site_name" content="Gimme The Code: TDD iOS"/><link rel="canonical" href="https://gimmetheco.de/uitests/chapter120"/><meta name="twitter:url" content="https://gimmetheco.de/uitests/chapter120"/><meta name="og:url" content="https://gimmetheco.de/uitests/chapter120"/><title>UI Tests Basics | Gimme The Code: TDD iOS</title><meta name="twitter:title" content="UI Tests Basics | Gimme The Code: TDD iOS"/><meta name="og:title" content="UI Tests Basics | Gimme The Code: TDD iOS"/><meta name="description" content="How to test iOS apps."/><meta name="twitter:description" content="How to test iOS apps."/><meta name="og:description" content="How to test iOS apps."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Gimme The Code: TDD iOS"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">Gimme The Code: TDD iOS</a></div></header><div class="wrapper"><article><div class="content"><h1>UI Tests Basics</h1><p>This chapter was inspired by <a href="https://github.com/joemasilotti/UI-Testing-Cheat-Sheet">joemasilotti/UI-Testing-Cheat-Sheet</a>.</p><h2>Existence Of A Label</h2><p>Test whether a label with the text 'Please log in' exists in the user interface.</p><pre><code><span class="keyword">func</span> test_label_exists() {

  <span class="keyword">let</span> app = <span class="type">XCUIApplication</span>()

  <span class="keyword">let</span> label = app.<span class="property">staticTexts</span>[<span class="string">"Please log in"</span>]
  <span class="call">XCTAssertTrue</span>(label.<span class="property">exists</span>)
}
</code></pre><h2>Text Input</h2><p>Insert text into a text field</p><pre><code><span class="keyword">func</span> test_textField_insertText() {

  <span class="keyword">let</span> app = <span class="type">XCUIApplication</span>()

  <span class="keyword">let</span> usernameTextField = app.<span class="property">textFields</span>[<span class="string">"Username"</span>]
  usernameTextField.<span class="call">tap</span>()
  usernameTextField.<span class="call">typeText</span>(<span class="string">"foobar"</span>)
}
</code></pre><h2>Button Tap</h2><p>Tap a button</p><pre><code><span class="keyword">func</span> test_buttonTouch_showsNextViewController() {

  <span class="keyword">let</span> app = <span class="type">XCUIApplication</span>()

  <span class="keyword">let</span> button = app.<span class="property">buttons</span>[<span class="string">"Login"</span>]
  button.<span class="call">tap</span>()

  <span class="keyword">let</span> titleExtists = app
    .<span class="dotAccess">navigationBars</span>[<span class="string">"All Items"</span>].exists
  <span class="call">XCTAssertTrue</span>(titleExtists)
}
</code></pre><h2>Scrolling</h2><p>Scroll a table view</p><pre><code><span class="keyword">func</span> test_scrolling() {

  <span class="keyword">let</span> app = <span class="type">XCUIApplication</span>()

  <span class="keyword">let</span> cell9 = app.<span class="property">cells</span>.<span class="call">element</span>(boundBy: <span class="number">9</span>)
  <span class="keyword">let</span> cell0 = app.<span class="property">cells</span>.<span class="call">element</span>(boundBy: <span class="number">0</span>)
  <span class="keyword">let</span> from = cell9.<span class="call">coordinate</span>(
    withNormalizedOffset:
    <span class="type">CGVector</span>(dx: <span class="number">0</span>, dy: <span class="number">0</span>))
  <span class="keyword">let</span> to = cell0.<span class="call">coordinate</span>(
    withNormalizedOffset:
    <span class="type">CGVector</span>(dx: <span class="number">0</span>, dy: <span class="number">0</span>))
  from.<span class="call">press</span>(forDuration: <span class="number">0</span>, thenDragTo: to)
}
</code></pre><h2>Selection Of A Table View Cell</h2><p>Test whether the selection of a table view cell pushes a view controller onto the navigation stack</p><pre><code><span class="keyword">func</span> test_selectionOfCell_showsDetails() {

  <span class="keyword">let</span> app = <span class="type">XCUIApplication</span>()

  <span class="keyword">let</span> cell =
    app.<span class="property">staticTexts</span>[<span class="string">"Section: 5, Row: 23"</span>]
  cell.<span class="call">tap</span>()
  <span class="keyword">let</span> titleExtists =
    app.<span class="property">navigationBars</span>[<span class="string">"Detail"</span>].exists
  <span class="call">XCTAssertTrue</span>(titleExtists)
}
</code></pre><h2>Push And Pop Of ViewControllers</h2><pre><code><span class="keyword">let</span> cell =
  app.<span class="property">staticTexts</span>[<span class="string">"Section: 5, Row: 23"</span>]
cell.<span class="call">tap</span>()

<span class="call">XCTAssertTrue</span>(
  app.<span class="property">navigationBars</span>[<span class="string">"Detail"</span>].exists)

</code></pre><pre><code>app.<span class="property">navigationBars</span>.<span class="property">buttons</span>.<span class="call">element</span>(
  boundBy: <span class="number">0</span>).<span class="call">tap</span>()

<span class="call">XCTAssertTrue</span>(
  app.<span class="property">navigationBars</span>[<span class="string">"All Items"</span>].exists)
</code></pre><h2>Pull To Refresh</h2><p>Pull down to refresh</p><pre><code><span class="keyword">func</span> test_pullToRefresh() {

  <span class="keyword">let</span> app = <span class="type">XCUIApplication</span>()

  <span class="keyword">let</span> cell0 = app.<span class="property">cells</span>.<span class="call">element</span>(boundBy: <span class="number">0</span>)
  <span class="keyword">let</span> from = cell0.<span class="call">coordinate</span>(
    withNormalizedOffset:
    <span class="type">CGVector</span>(dx: <span class="number">0</span>, dy: <span class="number">0</span>))
  <span class="keyword">let</span> to = cell0.<span class="call">coordinate</span>(
    withNormalizedOffset:
    <span class="type">CGVector</span>(dx: <span class="number">0</span>, dy: <span class="number">6</span>))
  from.<span class="call">press</span>(forDuration: <span class="number">0</span>, thenDragTo: to)
}
</code></pre><h2>Alerts</h2><p>React on alerts</p><pre><code><span class="keyword">func</span> test_alert() {

  <span class="keyword">let</span> app = <span class="type">XCUIApplication</span>()

  app.<span class="property">buttons</span>[<span class="string">"Show Alert"</span>].<span class="call">tap</span>()

  app.<span class="property">alerts</span>.<span class="property">buttons</span>[<span class="string">"OK"</span>].<span class="call">tap</span>()
}
</code></pre><h2>Change Orientation</h2><pre><code><span class="type">XCUIDevice</span>.<span class="property">shared</span>.<span class="property">orientation</span> = .<span class="dotAccess">landscapeLeft</span>
</code></pre><h2>Screenshot</h2><pre><code><span class="keyword">func</span> test_takeScreenshot() {

  <span class="keyword">let</span> app = <span class="type">XCUIApplication</span>()

  <span class="keyword">let</span> screenshot =
    app.<span class="property">windows</span>.<span class="property">firstMatch</span>.<span class="call">screenshot</span>()
  <span class="keyword">let</span> attachment =
    <span class="type">XCTAttachment</span>(screenshot: screenshot,
                  quality: .<span class="dotAccess">original</span>)
  attachment.<span class="property">lifetime</span> = .<span class="dotAccess">keepAlways</span>
  <span class="call">add</span>(attachment)
}
</code></pre><h2>Delete App</h2><p>Delete the app in a tear down block to get a clean state for the next tests</p><pre><code><span class="keyword">func</span> test_something() {

  <span class="call">addTeardownBlock</span> {
    <span class="keyword">self</span>.<span class="property">app</span>.<span class="call">delete</span>()
  }

  <span class="comment">// ... test ...</span>
}

<span class="keyword">extension</span> <span class="type">XCUIApplication</span> {
  <span class="keyword">func</span> delete() {

    <span class="call">delete</span>(app: <span class="keyword">self</span>.<span class="property">label</span>)
  }

  <span class="keyword">func</span> delete(app: <span class="type">String</span>) {

    <span class="keyword">self</span>.<span class="call">terminate</span>()

    <span class="keyword">let</span> springboard = <span class="type">XCUIApplication</span>(
      bundleIdentifier: <span class="string">"com.apple.springboard"</span>)

    <span class="keyword">let</span> appIcon = springboard.<span class="property">icons</span>[app]
    <span class="keyword">if</span> appIcon.<span class="property">exists</span> {

      appIcon.<span class="call">press</span>(forDuration: <span class="number">1.3</span>)

      springboard.<span class="property">buttons</span>[<span class="string">"Delete App"</span>].<span class="call">tap</span>()

      <span class="type">Thread</span>.<span class="call">sleep</span>(forTimeInterval: <span class="number">0.8</span>)

      springboard.<span class="property">alerts</span>.<span class="property">buttons</span>[<span class="string">"Delete"</span>].<span class="call">tap</span>()

      <span class="type">Thread</span>.<span class="call">sleep</span>(forTimeInterval: <span class="number">0.8</span>)

      <span class="type">XCUIDevice</span>.<span class="property">shared</span>.<span class="call">press</span>(.<span class="dotAccess">home</span>)
    }
  }
}
</code></pre><h2>System Alerts (like Location Services)</h2><p>React on system alerts like authorisation for location services</p><pre><code><span class="keyword">func</span> test_auth() {

  <span class="keyword">var</span> didAskForAuth = <span class="keyword">false</span>

  <span class="comment">// add monitor</span>
  <span class="keyword">let</span> monitor = <span class="call">addUIInterruptionMonitor</span>(
  withDescription: <span class="string">"Location Services"</span>) {
    alert -&gt; <span class="type">Bool</span> <span class="keyword">in</span>

    didAskForAuth = <span class="keyword">true</span>

    alert.<span class="property">buttons</span>[<span class="string">"Don’t Allow"</span>].<span class="call">tap</span>()
    <span class="keyword">return true</span>
  }

  <span class="call">addTeardownBlock</span> {
    <span class="comment">// remove monitor</span>
    <span class="keyword">self</span>.<span class="call">removeUIInterruptionMonitor</span>(monitor)
    <span class="keyword">self</span>.<span class="property">app</span>.<span class="call">delete</span>()
  }

  app.<span class="property">buttons</span>[<span class="string">"Auth"</span>].<span class="call">tap</span>()

  <span class="comment">// this is needed to trigger the handler</span>
  app.<span class="call">tap</span>()

  <span class="call">XCTAssertTrue</span>(didAskForAuth)
}
</code></pre></div><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/uitests">UITests</a></li></ul></article></div><footer><p><a href="https://www.buymeacoffee.com/dasdom">Buy me a coffee</a></p><p><a href="https://twitter.com/dasdom">Twitter</a><a> | </a><a href="https://github.com/dasdom">Github</a><a> | </a><a href="https://pragprog.com/titles/dhios/">My Book</a></p><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p></footer></body></html>